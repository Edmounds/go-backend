{
  "database_name": "miniprogram_db",
  "collections": {
    "users": {
      "description": "用户集合",
                   "sample_data": [
        {
          "openID": "wx_openid_example_123",
          "user_name": "john_doe",
          "user_password": "$2b$10$hashed_password_example",
          "class": "计算机科学与技术1班",
          "age": 20,
          "school": "北京大学",
          "phone": "13800138000",
          "city": "北京市",
          "agent_level": 0,
          "referral_code": "JOHN123",
          "referred_by": "",
          "collected_cards": [],
          "addresses": [],
          "progress": {
            "current_unit": "Unit 1",
            "current_sentence": "Hello, how are you?",
            "learned_words": ["hello", "how", "are", "you"]
          },
          "is_agent": false,
  
          "managed_schools": [],
          "managed_regions": [],
          "created_at": "2024-01-01T00:00:00.000Z",
          "updated_at": "2024-01-01T00:00:00.000Z"
        }
      ],
      "indexes": [
        {"keys": {"openID": 1}, "options": {"unique": true}},
        {"keys": {"user_name": 1}, "options": {"unique": true}},
        {"keys": {"phone": 1}, "options": {"unique": true}},
        {"keys": {"referral_code": 1}, "options": {"unique": true}},
        {"keys": {"referred_by": 1}},
        {"keys": {"school": 1}},
        {"keys": {"agent_level": 1}},
        {"keys": {"city": 1}},
        {"keys": {"is_agent": 1}}
      ]
    },
    "products": {
      "description": "商品集合",
             "sample_data": [
         {
           "product_id": "PROD001",
           "name": "英语学习卡片套装",
           "price": 99.9,
           "description": "包含1000个常用英语单词卡片"
         }
       ],
      "indexes": [
        {"keys": {"product_id": 1}, "options": {"unique": true}},
        {"keys": {"name": 1}},
        {"keys": {"price": 1}}
      ]
    },
    "addresses": {
      "description": "地址集合",
             "sample_data": [
         {
           "user_id": "ObjectId_Reference",
           "recipient_name": "张三",
           "phone": "13800138001",
           "province": "北京市",
           "city": "北京市",
           "district": "海淀区",
           "street": "中关村大街1号",
           "postal_code": "100000",
           "is_default": true
         }
       ],
      "indexes": [
        {"keys": {"user_id": 1}},
        {"keys": {"user_id": 1, "is_default": 1}}
      ]
    },
    "carts": {
      "description": "购物车集合",
             "sample_data": [
         {
           "cart_id": "CART001",
           "user_id": "ObjectId_Reference",
           "items": [
             {
               "product_id": "ObjectId_Reference",
               "quantity": 1,
               "price": 99.9
             }
           ],
           "total_price": 99.9
         }
       ],
      "indexes": [
        {"keys": {"user_id": 1}, "options": {"unique": true}},
        {"keys": {"cart_id": 1}, "options": {"unique": true}}
      ]
    },
    "orders": {
      "description": "订单集合",
             "sample_data": [
         {
           "order_id": "ORDER001",
           "user_id": "ObjectId_Reference",
           "address_id": "ObjectId_Reference",
           "products": [
             {
               "product_id": "ObjectId_Reference",
               "quantity": 1,
               "price": 99.9
             }
           ],
           "subtotal": 99.9,
           "total_price": 109.9,
           "discount_applied": 0,
           "referral_discount": 5,
           "shipping_fee": 10,
           "price_breakdown": {
             "subtotal": 99.9,
             "discount_details": [
               {
                 "type": "referral",
                 "amount": 5,
                 "description": "推荐码折扣"
               }
             ],
             "shipping_fee": 10,
             "final_total": 109.9
           },
           "status": "pending",
           "payment_method": "wechat_pay",
           "referral_code": "",
           "referral_bonus_applied": false
         }
       ],
      "indexes": [
        {"keys": {"order_id": 1}, "options": {"unique": true}},
        {"keys": {"user_id": 1}},
        {"keys": {"status": 1}},
        {"keys": {"created_at": -1}},
        {"keys": {"referral_code": 1}}
      ]
    },
    "referrals": {
      "description": "推荐码集合",
             "sample_data": [
         {
           "referral_code": "JOHN123",
           "user_id": "ObjectId_Reference",
           "used_by": []
         }
       ],
      "indexes": [
        {"keys": {"referral_code": 1}, "options": {"unique": true}},
        {"keys": {"user_id": 1}, "options": {"unique": true}}
      ]
    },
    "commissions": {
      "description": "佣金集合",
             "sample_data": [
         {
           "commission_id": "COMM001",
           "user_id": "ObjectId_Reference",
           "amount": 10.5,
           "date": "2024-01-01T00:00:00.000Z",
           "status": "pending",
           "type": "referral"
         }
       ],
      "indexes": [
        {"keys": {"commission_id": 1}, "options": {"unique": true}},
        {"keys": {"user_id": 1}},
        {"keys": {"status": 1}},
        {"keys": {"type": 1}},
        {"keys": {"date": -1}}
      ]
    },
    "books": {
      "description": "书籍集合",
             "sample_data": [
         {
           "book_name": "新概念英语第一册",
           "book_version": "2024版",
           "units": [
             "ObjectId_Reference"
           ]
         }
       ],
      "indexes": [
        {"keys": {"book_name": 1, "book_version": 1}, "options": {"unique": true}}
      ]
    },
    "units": {
      "description": "单元集合",
             "sample_data": [
         {
           "unit_name": "Unit 1: Greetings",
           "book_id": "ObjectId_Reference"
         }
       ],
      "indexes": [
        {"keys": {"book_id": 1}},
        {"keys": {"unit_name": 1, "book_id": 1}, "options": {"unique": true}}
      ]
    },
    "words": {
      "description": "单词集合",
             "sample_data": [
         {
           "word_name": "hello",
           "word_meaning": "你好",
           "pronunciation_url": "https://example.com/audio/hello.mp3",
           "img_url": "https://example.com/images/hello.jpg",
           "unit_id": "ObjectId_Reference",
           "book_id": "ObjectId_Reference"
         }
       ],
      "indexes": [
        {"keys": {"word_name": 1}},
        {"keys": {"unit_id": 1}},
        {"keys": {"book_id": 1}},
        {"keys": {"word_name": 1, "unit_id": 1}, "options": {"unique": true}}
      ]
         }
   },
   "initialization_notes": {
     "description": "MongoDB 集合初始化说明",
     "auto_generated_fields": {
       "_id": "MongoDB 会自动生成 ObjectId 作为主键，无需手动指定",
       "created_at": "可以通过 MongoDB 默认值或应用程序逻辑自动设置为当前时间",
       "updated_at": "应该在每次更新文档时自动设置为当前时间，可通过应用程序逻辑或 MongoDB 中间件实现"
     },
     "steps": [
       "1. 创建数据库 'miniprogram_db'",
       "2. 为每个集合创建相应的索引以优化查询性能",
       "3. 插入示例数据（可选，_id、created_at 和 updated_at 会自动生成）",
       "4. 设置适当的读写权限"
     ],
     "important_notes": [
       "所有密码字段都应该使用 bcrypt 进行哈希处理",
       "时间字段统一使用 ISO 8601 格式",
       "用户的推荐码必须唯一",
       "订单ID和商品ID等业务标识符需要保证唯一性",
       "地址集合中每个用户只能有一个默认地址",
       "购物车集合中每个用户只能有一个购物车",
       "_id 字段会由 MongoDB 自动生成，无需在插入数据时指定",
       "created_at 字段建议在应用层或通过 MongoDB 默认值自动设置",
       "updated_at 字段应该在每次更新操作时自动设置为当前时间"
     ],
     "performance_tips": [
       "为经常查询的字段创建索引",
       "考虑使用复合索引优化多字段查询",
       "对于大量数据的集合，考虑分片策略",
       "定期监控查询性能并优化索引",
       "ObjectId 本身包含时间戳信息，可以用于排序和时间查询"
     ],
     "reference_fields_note": "示例数据中的 'ObjectId_Reference' 表示该字段应该引用其他集合的 ObjectId"
   }
 }