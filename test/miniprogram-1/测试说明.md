# 微信小程序英语学习平台 - 完整测试工具

## 概述

这是一个完整的微信小程序测试工具，用于测试英语学习平台的所有功能模块。包含前端界面和后端API的全面测试，适用于开发、测试和演示场景。

## 功能模块

### 1. 用户认证测试 (👤)
**文件位置**: `pages/login/`
**功能说明**:
- 微信一键登录测试
- 用户信息获取和保存
- JWT Token管理
- 登录状态检查

**测试要点**:
- 微信登录接口 `POST /api/auth`
- Token存储和验证
- 用户信息同步

### 2. 学习进度测试 (📚)
**文件位置**: `pages/learning/`
**功能说明**:
- 书籍列表获取
- 用户学习进度管理
- 学习数据更新
- 已学单词跟踪

**测试要点**:
- 获取书籍列表 `GET /api/books`
- 获取学习进度 `GET /api/users/:user_id/progress`
- 更新学习进度 `PUT /api/users/:user_id/progress`
- 书籍单词查询 `GET /api/books/:book_id/words`

### 3. 单词卡片测试 (🃏)
**文件位置**: `pages/wordcard/`
**功能说明**:
- 按单元ID获取单词列表
- 按单元名称获取单词
- 单词卡片详情查看
- 图片预览和发音播放

**测试要点**:
- 单元单词查询 `GET /api/units/:unit_id/words`
- 单词卡片详情 `GET /api/words/:word_name/card`
- 按名称查询单词 `GET /api/words?unit_name=xxx&book_name=xxx`

### 4. 商店功能测试 (🛒)
**文件位置**: `pages/store/`
**功能说明**:
- 商品列表浏览
- 购物车管理
- 订单创建和查看
- 商品详情展示

**测试要点**:
- 商品列表 `GET /api/products`
- 商品详情 `GET /api/product/:product_id`
- 购物车操作 `POST/PUT/DELETE /api/users/:user_id/cart`
- 订单管理 `POST/GET /api/users/:user_id/orders`

### 5. 推荐系统测试 (🎯)
**文件位置**: `pages/referral/`
**功能说明**:
- 推荐码验证
- 推荐关系建立
- 推荐信息查看
- 折扣计算模拟

**测试要点**:
- 推荐码验证 `POST /api/referrals/validate`
- 推荐关系跟踪 `POST /api/referrals`
- 推荐信息获取 `GET /api/users/:user_id/referral`

### 6. 佣金管理测试 (💰)
**文件位置**: `pages/commission/`
**功能说明**:
- 佣金记录查看
- 状态和类型筛选
- 佣金统计展示
- 下拉刷新功能

**测试要点**:
- 佣金记录查询 `GET /api/users/:user_id/referral/commissions`
- 筛选条件测试
- 数据统计功能

### 7. 代理管理测试 (👥)
**文件位置**: `pages/agent/`
**功能说明**:
- 代理用户管理
- 销售数据分析
- 佣金提取申请
- 多标签页切换

**测试要点**:
- 代理用户列表 `GET /api/agents/:user_id/users`
- 销售数据查询 `GET /api/agents/:user_id/sales`
- 佣金提取 `POST /api/agents/:user_id/withdraw`

### 8. 管理员功能测试 (⚙️)
**文件位置**: `pages/admin/`
**功能说明**:
- 用户代理等级管理
- 预设用户测试
- 批量操作功能
- 操作日志记录

**测试要点**:
- 代理等级更新 `PUT /api/admin/users/:user_id/agent-level`
- 批量测试功能
- 错误处理和日志

## 技术特点

### 前端架构
- **框架**: 微信小程序原生开发
- **工具函数**: 统一的API调用、认证管理、配置管理
- **UI设计**: 现代化界面，良好的用户体验
- **错误处理**: 完善的错误提示和异常处理

### API调用
- **统一封装**: `utils/api.js` 包含所有接口调用
- **认证管理**: `utils/auth.js` 处理登录状态和Token
- **请求拦截**: 自动添加认证头，处理401错误
- **错误处理**: 统一的错误提示和重试机制

### 数据管理
- **本地存储**: 使用微信小程序Storage API
- **状态管理**: 页面级状态管理，数据实时更新
- **缓存策略**: 合理的数据缓存和刷新机制

## 使用方法

### 1. 启动后端服务
```bash
cd miniprogram
go run main.go
```
确保后端服务在 `http://localhost:8080` 运行

### 2. 配置小程序
在 `utils/config.js` 中确认API地址配置：
```javascript
apiBaseUrl: 'http://localhost:8080/api'
```

### 3. 开始测试
1. 打开微信开发者工具
2. 导入 `test/miniprogram-1` 目录
3. 启动小程序预览
4. 从首页选择要测试的功能模块

### 4. 测试流程建议
1. **用户认证**: 先进行微信登录测试
2. **基础功能**: 测试学习进度、单词卡片等核心功能
3. **商城功能**: 测试商品浏览、购物车、订单流程
4. **推荐系统**: 测试推荐码、佣金等高级功能
5. **管理功能**: 测试代理管理、管理员后台功能

## 注意事项

### 环境要求
- 微信开发者工具最新版本
- 后端Go服务正常运行
- MongoDB数据库连接正常

### 测试数据
- 小程序包含预设的测试用户数据
- 管理员功能提供模拟用户进行测试
- 所有功能都有完整的错误处理

### 常见问题
1. **登录失败**: 检查后端服务是否启动，API地址是否正确
2. **接口调用失败**: 确认Token是否有效，网络连接是否正常
3. **数据不显示**: 检查数据格式是否正确，是否有权限访问

### 开发建议
- 每个功能模块都有独立的错误处理
- 可以根据实际需求修改API地址和参数
- 建议在真实环境中测试所有功能
- 可以扩展更多测试用例和场景

## 项目结构
```
test/miniprogram-1/
├── pages/              # 页面文件
│   ├── profile/        # 首页（功能导航）
│   ├── login/          # 用户认证测试
│   ├── learning/       # 学习进度测试
│   ├── wordcard/       # 单词卡片测试
│   ├── store/          # 商店功能测试
│   ├── referral/       # 推荐系统测试
│   ├── commission/     # 佣金管理测试
│   ├── agent/          # 代理管理测试
│   └── admin/          # 管理员功能测试
├── utils/              # 工具函数
│   ├── api.js          # API接口调用
│   ├── auth.js         # 认证管理
│   ├── config.js       # 配置文件
│   └── util.js         # 通用工具
├── images/             # 图片资源
├── app.js              # 应用入口
├── app.json            # 应用配置
├── app.wxss            # 全局样式
└── 测试说明.md         # 本文档
```

这个测试工具提供了完整的功能覆盖，可以有效验证微信小程序英语学习平台的所有核心功能。